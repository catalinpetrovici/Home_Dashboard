import PieCharts from '../components/PieChart';
import { useRef } from 'react';
import axiosIns from '../utils/axios';
import { QueryClient } from '@tanstack/react-query';
import { useLoaderData } from 'react-router-dom';

const fetchData = async () => {
  const res = await axiosIns.get('/api/v1/nowtemp');
  return res.data;
};

const data123 = [
  { name: 'Group A', value: 10 },
  { name: 'Group A', value: 5 },
  { name: 'Group B', value: 10 },
];

const COLORS = [
  { start: '#1BA43A60', end: '#A5C71160' },
  { start: '#9ece00', end: '#9ece00' },
  { start: '#F3912460', end: '#FDC73960' },
];

const data2 = [
  { name: 'Group A', value: 40 },
  { name: 'Group B', value: 20 },
  { name: 'Group B', value: 20 },
];

const COLORS2 = [
  { start: '#d94d5960', end: '#9B8DA660' },
  { start: '#59BADB', end: '#59BADB' },
  { start: '#5998E760', end: '#4E69DC60' },
];

type Data = {
  tempInside: number;
  humInside: number;
  tempOutside: number;
  humOutside: number;
};

const Home = () => {
  const ref = useRef<HTMLDivElement>(null);
  const data = useLoaderData() as Data;

  return (
    <div ref={ref} className=''>
      <h1 className='title text-white'>Welcome home</h1>
      <div className='flex flex-wrap'>
        <section className='group-1 max-300 m-1'>
          <div className='test'>
            <span className='mb-2 block text-[#ffffff72]'>
              How's the air quality?
            </span>
            <span>The air quality is good and fresh you can go out today</span>
          </div>
        </section>
        <section className='group-3 max-300 m-1'>
          <div className='test'>
            <span className='mb-2 block text-[#ffffff72]'>Inside</span>
            <div className='inline-block'>
              <span className='mr-3'>
                <svg
                  className='inline'
                  fill={`${data.tempInside > 0 ? '#fe696972' : '#557aff72'}`}
                  height='30px'
                  width='30px'
                  version='1.1'
                  id='Capa_1'
                  viewBox='0 0 490 490'
                  xmlSpace='preserve'
                >
                  <g>
                    <g>
                      <path
                        d='M262.096,490c-14.151,0-27.883-2.774-40.818-8.245c-12.487-5.281-23.7-12.841-33.326-22.468
			c-9.626-9.626-17.185-20.838-22.468-33.326c-5.47-12.933-8.244-26.666-8.244-40.816c0-16.766,4.058-33.445,11.733-48.233
			c6.607-12.729,15.9-24.11,27.054-33.183V49.967C196.028,22.415,218.443,0,245.996,0h32.201c27.552,0,49.968,22.415,49.968,49.967
			v253.762c11.154,9.072,20.447,20.453,27.054,33.183c7.676,14.788,11.733,31.468,11.733,48.233c0,14.15-2.773,27.884-8.245,40.816
			c-5.282,12.488-12.84,23.7-22.467,33.326c-9.626,9.627-20.839,17.186-33.327,22.468C289.981,487.226,276.248,490,262.096,490z
			 M245.996,20.578c-16.205,0-29.389,13.184-29.389,29.389V308.78c0,3.281-1.565,6.366-4.213,8.304
			c-21.649,15.84-34.574,41.283-34.574,68.06c0,46.47,37.806,84.276,84.277,84.276c46.471,0,84.277-37.807,84.277-84.276
			c0-26.777-12.925-52.221-34.575-68.06c-2.648-1.938-4.213-5.023-4.213-8.304V49.967c0-16.205-13.184-29.389-29.389-29.389H245.996
			z'
                      />
                    </g>
                    <path
                      d='M283.943,325.025v-224.65c0-8.918-7.229-16.147-16.146-16.147h-11.402c-8.917,0-16.146,7.229-16.146,16.147v224.65
		c-24.561,8.927-42.105,32.475-42.105,60.121c0,35.32,28.632,63.953,63.952,63.953c35.32,0,63.953-28.633,63.953-63.953
		C326.048,357.5,308.505,333.952,283.943,325.025z M247.931,365.24c-4.783,4.243-7.878,9.827-8.949,16.148
		c-0.563,3.33-0.526,6.681,0.113,9.957c0.819,4.204-1.925,8.276-6.13,9.096c-0.501,0.099-1,0.146-1.492,0.146
		c-3.637,0-6.883-2.57-7.605-6.274c-0.997-5.117-1.057-10.337-0.18-15.514c1.643-9.707,6.598-18.643,13.95-25.164
		c3.205-2.842,8.107-2.549,10.95,0.656C251.429,357.496,251.136,362.397,247.931,365.24z'
                    />
                    <g>
                      <g>
                        <g>
                          <path
                            d='M157.262,75.302c0,4.658-3.776,8.436-8.436,8.436h-17.341c-4.66,0-8.437-3.778-8.437-8.436v-9.192
					c0-4.66,3.777-8.437,8.437-8.437h17.341c4.66,0,8.436,3.776,8.436,8.437V75.302z'
                          />
                          <path
                            d='M157.262,130.298c0,4.66-3.776,8.437-8.436,8.437h-17.341c-4.66,0-8.437-3.776-8.437-8.437v-9.192
					c0-4.66,3.777-8.437,8.437-8.437h17.341c4.66,0,8.436,3.776,8.436,8.437V130.298z'
                          />
                          <path
                            d='M157.262,185.294c0,4.66-3.776,8.437-8.436,8.437h-17.341c-4.66,0-8.437-3.776-8.437-8.437v-9.191
					c0-4.659,3.777-8.438,8.437-8.438h17.341c4.66,0,8.436,3.778,8.436,8.438V185.294z'
                          />
                        </g>
                        <path
                          d='M157.262,240.291c0,4.659-3.776,8.438-8.436,8.438h-17.341c-4.66,0-8.437-3.778-8.437-8.438V231.1
				c0-4.66,3.777-8.436,8.437-8.436h17.341c4.66,0,8.436,3.776,8.436,8.436V240.291z'
                        />
                      </g>
                      <path
                        d='M157.262,295.287c0,4.661-3.776,8.438-8.436,8.438h-17.341c-4.66,0-8.437-3.776-8.437-8.438v-9.191
			c0-4.658,3.777-8.436,8.437-8.436h17.341c4.66,0,8.436,3.778,8.436,8.436V295.287z'
                      />
                    </g>
                  </g>
                </svg>
                {data.tempInside}
              </span>
            </div>
            <div className='inline-block'>
              <span>
                <svg
                  className='inline'
                  fill='#6b7fff71'
                  height='30px'
                  width='30px'
                  version='1.1'
                  id='Capa_1'
                  viewBox='0 0 328.611 328.611'
                  xmlSpace='preserve'
                >
                  <g>
                    <path
                      d='M209.306,50.798c-2.452-3.337-7.147-4.055-10.485-1.602c-3.338,2.453-4.055,7.147-1.603,10.485
		c54.576,74.266,66.032,123.541,66.032,151.8c0,27.691-8.272,52.794-23.293,70.685c-17.519,20.866-42.972,31.446-75.651,31.446
		c-73.031,0-98.944-55.018-98.944-102.131c0-52.227,28.103-103.234,51.679-136.829c25.858-36.847,52.11-61.415,52.37-61.657
		c3.035-2.819,3.209-7.565,0.39-10.6c-2.819-3.034-7.565-3.209-10.599-0.39c-1.11,1.031-27.497,25.698-54.254,63.765
		c-24.901,35.428-54.586,89.465-54.586,145.71c0,31.062,9.673,59.599,27.236,80.353c20.361,24.061,50.345,36.779,86.708,36.779
		c36.794,0,66.926-12.726,87.139-36.801c17.286-20.588,26.806-49.117,26.806-80.33C278.25,156.216,240.758,93.597,209.306,50.798z'
                    />
                    <path
                      d='M198.43,148.146l-95.162,95.162c-2.929,2.929-2.929,7.678,0,10.606c1.465,1.464,3.385,2.197,5.304,2.197
		s3.839-0.732,5.304-2.197l95.162-95.162c2.929-2.929,2.929-7.678,0-10.606C206.107,145.217,201.359,145.217,198.43,148.146z'
                    />
                    <path
                      d='M191.965,207.899c-13.292,0-24.106,10.814-24.106,24.106s10.814,24.106,24.106,24.106s24.106-10.814,24.106-24.106
		S205.257,207.899,191.965,207.899z M191.965,241.111c-5.021,0-9.106-4.085-9.106-9.106s4.085-9.106,9.106-9.106
		s9.106,4.085,9.106,9.106S196.986,241.111,191.965,241.111z'
                    />
                    <path
                      d='M125.178,194.162c13.292,0,24.106-10.814,24.106-24.106s-10.814-24.106-24.106-24.106s-24.106,10.814-24.106,24.106
		S111.886,194.162,125.178,194.162z M125.178,160.949c5.021,0,9.106,4.085,9.106,9.106s-4.085,9.106-9.106,9.106
		c-5.021,0-9.106-4.085-9.106-9.106S120.156,160.949,125.178,160.949z'
                    />
                  </g>
                </svg>
                {data.humInside}
              </span>
            </div>
          </div>
          <div className='test'>
            <span className='mb-2 block  text-[#ffffff72]'>Outside</span>
            <div className='inline-block'>
              <span className='mr-3'>
                <svg
                  className='inline'
                  fill={`${data.tempOutside > 0 ? '#fe696972' : '#557aff72'}`}
                  height='30px'
                  width='30px'
                  version='1.1'
                  id='Capa_1'
                  viewBox='0 0 490 490'
                  xmlSpace='preserve'
                >
                  <g>
                    <g>
                      <path
                        d='M262.096,490c-14.151,0-27.883-2.774-40.818-8.245c-12.487-5.281-23.7-12.841-33.326-22.468
			c-9.626-9.626-17.185-20.838-22.468-33.326c-5.47-12.933-8.244-26.666-8.244-40.816c0-16.766,4.058-33.445,11.733-48.233
			c6.607-12.729,15.9-24.11,27.054-33.183V49.967C196.028,22.415,218.443,0,245.996,0h32.201c27.552,0,49.968,22.415,49.968,49.967
			v253.762c11.154,9.072,20.447,20.453,27.054,33.183c7.676,14.788,11.733,31.468,11.733,48.233c0,14.15-2.773,27.884-8.245,40.816
			c-5.282,12.488-12.84,23.7-22.467,33.326c-9.626,9.627-20.839,17.186-33.327,22.468C289.981,487.226,276.248,490,262.096,490z
			 M245.996,20.578c-16.205,0-29.389,13.184-29.389,29.389V308.78c0,3.281-1.565,6.366-4.213,8.304
			c-21.649,15.84-34.574,41.283-34.574,68.06c0,46.47,37.806,84.276,84.277,84.276c46.471,0,84.277-37.807,84.277-84.276
			c0-26.777-12.925-52.221-34.575-68.06c-2.648-1.938-4.213-5.023-4.213-8.304V49.967c0-16.205-13.184-29.389-29.389-29.389H245.996
			z'
                      />
                    </g>
                    <path
                      d='M283.943,325.025v-224.65c0-8.918-7.229-16.147-16.146-16.147h-11.402c-8.917,0-16.146,7.229-16.146,16.147v224.65
		c-24.561,8.927-42.105,32.475-42.105,60.121c0,35.32,28.632,63.953,63.952,63.953c35.32,0,63.953-28.633,63.953-63.953
		C326.048,357.5,308.505,333.952,283.943,325.025z M247.931,365.24c-4.783,4.243-7.878,9.827-8.949,16.148
		c-0.563,3.33-0.526,6.681,0.113,9.957c0.819,4.204-1.925,8.276-6.13,9.096c-0.501,0.099-1,0.146-1.492,0.146
		c-3.637,0-6.883-2.57-7.605-6.274c-0.997-5.117-1.057-10.337-0.18-15.514c1.643-9.707,6.598-18.643,13.95-25.164
		c3.205-2.842,8.107-2.549,10.95,0.656C251.429,357.496,251.136,362.397,247.931,365.24z'
                    />
                    <g>
                      <g>
                        <g>
                          <path
                            d='M157.262,75.302c0,4.658-3.776,8.436-8.436,8.436h-17.341c-4.66,0-8.437-3.778-8.437-8.436v-9.192
					c0-4.66,3.777-8.437,8.437-8.437h17.341c4.66,0,8.436,3.776,8.436,8.437V75.302z'
                          />
                          <path
                            d='M157.262,130.298c0,4.66-3.776,8.437-8.436,8.437h-17.341c-4.66,0-8.437-3.776-8.437-8.437v-9.192
					c0-4.66,3.777-8.437,8.437-8.437h17.341c4.66,0,8.436,3.776,8.436,8.437V130.298z'
                          />
                          <path
                            d='M157.262,185.294c0,4.66-3.776,8.437-8.436,8.437h-17.341c-4.66,0-8.437-3.776-8.437-8.437v-9.191
					c0-4.659,3.777-8.438,8.437-8.438h17.341c4.66,0,8.436,3.778,8.436,8.438V185.294z'
                          />
                        </g>
                        <path
                          d='M157.262,240.291c0,4.659-3.776,8.438-8.436,8.438h-17.341c-4.66,0-8.437-3.778-8.437-8.438V231.1
				c0-4.66,3.777-8.436,8.437-8.436h17.341c4.66,0,8.436,3.776,8.436,8.436V240.291z'
                        />
                      </g>
                      <path
                        d='M157.262,295.287c0,4.661-3.776,8.438-8.436,8.438h-17.341c-4.66,0-8.437-3.776-8.437-8.438v-9.191
			c0-4.658,3.777-8.436,8.437-8.436h17.341c4.66,0,8.436,3.778,8.436,8.436V295.287z'
                      />
                    </g>
                  </g>
                </svg>
                {data.tempOutside}
              </span>
            </div>
            <div className='inline-block'>
              <span>
                <svg
                  className='inline'
                  fill='#6b7fff71'
                  height='30px'
                  width='30px'
                  version='1.1'
                  id='Capa_1'
                  viewBox='0 0 328.611 328.611'
                  xmlSpace='preserve'
                >
                  <g>
                    <path
                      d='M209.306,50.798c-2.452-3.337-7.147-4.055-10.485-1.602c-3.338,2.453-4.055,7.147-1.603,10.485
		c54.576,74.266,66.032,123.541,66.032,151.8c0,27.691-8.272,52.794-23.293,70.685c-17.519,20.866-42.972,31.446-75.651,31.446
		c-73.031,0-98.944-55.018-98.944-102.131c0-52.227,28.103-103.234,51.679-136.829c25.858-36.847,52.11-61.415,52.37-61.657
		c3.035-2.819,3.209-7.565,0.39-10.6c-2.819-3.034-7.565-3.209-10.599-0.39c-1.11,1.031-27.497,25.698-54.254,63.765
		c-24.901,35.428-54.586,89.465-54.586,145.71c0,31.062,9.673,59.599,27.236,80.353c20.361,24.061,50.345,36.779,86.708,36.779
		c36.794,0,66.926-12.726,87.139-36.801c17.286-20.588,26.806-49.117,26.806-80.33C278.25,156.216,240.758,93.597,209.306,50.798z'
                    />
                    <path
                      d='M198.43,148.146l-95.162,95.162c-2.929,2.929-2.929,7.678,0,10.606c1.465,1.464,3.385,2.197,5.304,2.197
		s3.839-0.732,5.304-2.197l95.162-95.162c2.929-2.929,2.929-7.678,0-10.606C206.107,145.217,201.359,145.217,198.43,148.146z'
                    />
                    <path
                      d='M191.965,207.899c-13.292,0-24.106,10.814-24.106,24.106s10.814,24.106,24.106,24.106s24.106-10.814,24.106-24.106
		S205.257,207.899,191.965,207.899z M191.965,241.111c-5.021,0-9.106-4.085-9.106-9.106s4.085-9.106,9.106-9.106
		s9.106,4.085,9.106,9.106S196.986,241.111,191.965,241.111z'
                    />
                    <path
                      d='M125.178,194.162c13.292,0,24.106-10.814,24.106-24.106s-10.814-24.106-24.106-24.106s-24.106,10.814-24.106,24.106
		S111.886,194.162,125.178,194.162z M125.178,160.949c5.021,0,9.106,4.085,9.106,9.106s-4.085,9.106-9.106,9.106
		c-5.021,0-9.106-4.085-9.106-9.106S120.156,160.949,125.178,160.949z'
                    />
                  </g>
                </svg>
                {data.humOutside}
              </span>
            </div>
          </div>
        </section>
        <section className='group-4 max-300 m-1'></section>
        {/* <section className='group-2 m-1'>
          <div className='test'>
            <span className='mb-2 block text-[#ffffff72]'>Temperature</span>
            <PieCharts key={1} data={data123} COLORS={COLORS} value='24°C' />
          </div>
          <div className='test mt-2'>
            <span className='mb-2 block text-[#ffffff72]'>Humidity</span>
            <PieCharts key={2} data={data2} COLORS={COLORS2} value='60%' />
          </div>
        </section> */}
      </div>
    </div>
  );
};

export default Home;

export function loader(queryClient: QueryClient) {
  return async () => {
    const data = queryClient.fetchQuery({
      queryKey: ['temp', 'now'],
      queryFn: fetchData,
    });
    if (data) return data;

    return queryClient.fetchQuery({
      queryKey: ['temp', 'now'],
      queryFn: () => {},
    });
  };
}
